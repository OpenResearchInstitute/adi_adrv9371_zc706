# COBS Decoder Test Vector Generator and Analyzer

Jupyter notebooks in Python that generate a random set of test vectors for the COBS decoder and then check the simulation output against the original random data.

Currently these take arguments in one of the first few cells of each notebook.

Test parameters are set in the tv-generator notebook. It generates a specified number of frames, each of which has a randomly-chosen length (within a specified range) and contains random bytes. Between frames, with a specified probability, it inserts a number of random "garbage" bytes (*Note:* this probability must be 0.0 if the sim-compare-frames notebook is to be used!) Then, without any regard for the contents of the random data stream thus generated, random s_tvalid and m_tready signals are inserted. These random handshaking signals are controlled by specified probabilities and random lengths within specified limits. The random s_tvalid signal is not allowed to go from high to low when the random m_tready signal is low, in accordance with the AXI-S protocol.

Thus, tv-generator (with garbage probability set to 0.0) creates a valid data stream that encodes the randomly-generated files, subjected to a torture test of random handshaking scenarios. The sim-compare-frames notebook simply extracts the decoded frames from the cycle-by-cycle output and compares them with the original random frames, and reports on any differences found.

The tv-generator notebook generates two files:
* a set of cycle-by-cycle input vectors in the format required by the VHDL testbench
* an encoded copy of the Python list of generated frames, made by Python's pickle

The sim-compare-frames notebook requires two input files:
* a set of cycle-by-cycle test results in the format generated by the VHDL testbench
* the encoded copy of generated frames, directly from tv-generator.

So the procedure is:
* adjust test parameters inside the tv-generator notebook
* run the tv-generator notebook
* import the resulting `COBS_dec-tv-in-xxxxxxxx.txt` file into the testbench as a data file
* change the filename inside the testbench to match (xxxxxxxx is the random seed used)
* run the simulation to completion
* obtain the `cobs-test-output.txt` file generated by the testbench
* run the sim-compare-frames notebook
* examine test results generated by the sim-compare-frames notebook

These notebooks may need to be converted to standalone Python programs, which should be straightforward. Inputs would move to the command line.
